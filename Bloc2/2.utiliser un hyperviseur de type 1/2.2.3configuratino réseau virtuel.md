# Fiche – Configuration du réseau virtuel sous Hyper-V

## 1. Contexte

* Les VM créées dans Hyper-V nécessitent des **commutateurs virtuels** pour communiquer entre elles ou avec le réseau physique.
* Chaque nouvelle VM possède un **adaptateur réseau** qui doit être relié à un commutateur virtuel pour activer la connectivité.
* Hyper-V propose **3 types de commutateurs virtuels** : Privé, Interne, Externe.

---

## 2. Types de commutateurs virtuels Hyper-V

| Type        | Communication                                         | Utilisation                                                       |
| ----------- | ----------------------------------------------------- | ----------------------------------------------------------------- |
| **Privé**   | Entre machines virtuelles uniquement                  | Environnements test, développement, opérations sensibles          |
| **Interne** | Entre machines virtuelles + OS hôte                   | Réseau privé avec accès contrôlé à certaines ressources de l’hôte |
| **Externe** | Entre machines virtuelles + OS hôte + réseau physique | VM accessibles à Internet ou au réseau local de l’hôte            |

### Points clés

* Commutateur externe → connecté à la carte physique, partage IP avec le réseau physique.
* Commutateurs interne et privé → isolation totale ou partielle du réseau physique.
* Fonctionnement dans la **couche 2** : dirige paquets, gère VLAN et QoS.
* Les systèmes invités traitent les adaptateurs virtuels comme des adaptateurs physiques.

---

## 3. Création d’un commutateur virtuel

1. Ouvrir **Hyper-V Manager** → **Gestionnaire de commutateurs virtuels**.
2. Choisir le type de commutateur (Privé, Interne, Externe).
3. Nommer le commutateur → **OK** pour créer.
4. Vérifier la création dans le gestionnaire.

---

## 4. Attribution d’un adaptateur réseau à une VM

1. Clic droit sur la VM → **Paramètres** → **Carte réseau**.
2. Sélectionner le **commutateur virtuel** créé.
3. Cliquer sur **OK** pour appliquer.

---

## 5. Exemple de configuration réseau privé

* Créer 2 VM (Windows 10 et Windows 7).
* Ajouter le **commutateur privé** à chaque VM.
* Configurer les IP statiques :

| VM         | IP            | Masque        | Passerelle   |
| ---------- | ------------- | ------------- | ------------ |
| Windows 10 | 192.168.10.10 | 255.255.255.0 | 192.168.10.1 |
| Windows 7  | 192.168.10.7  | 255.255.255.0 | 192.168.10.1 |

* Test de connectivité : ping de Windows 10 → Windows 7 → OK.

> ⚠ Attention : ne pas mettre la passerelle de l’hôte si les VM doivent rester isolées du réseau physique.

---

## 6. Remarques pratiques

* Le commutateur interne crée un **adaptateur vEthernet sur l’hôte**, le privé non.
* Les réseaux virtuels permettent de créer plusieurs isolations pour tester différents scénarios.
* Pour connecter une VM à Internet ou au réseau local → utiliser **commutateur externe**.

---