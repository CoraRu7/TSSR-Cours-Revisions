# **PowerShell : Installation et commandes de base**

## **Objectif**

Installer correctement PowerShell sur Windows et Linux, vérifier son fonctionnement et apprendre les commandes essentielles pour l’administration système.

---

## **Concepts clés**

### **1. Qu’est-ce que PowerShell ?**

* Shell en ligne de commande et langage de script basé sur **.NET**.
* Permet **l’automatisation des tâches** et la **gestion des configurations**.
* Multiplateforme et open source : disponible sur Windows et Linux.
* Fonctionnalités :

  * Cmdlets pour l’administration système
  * Gestion de services, processus, registres, événements
  * PowerShell Remoting pour administrer des systèmes distants

---

### **2. Vérification de l’installation**

* **Windows** : rechercher « PowerShell » dans le menu Démarrer → si visible → installé.
* **Linux** : `$ pwsh` → si lancé → installé.
* **Vérifier la version** :

```powershell
$PsVersionTable
```

---

### **3. Installation de PowerShell**

#### **Sous Windows 10**

1. Télécharger le **MSI officiel** : [PowerShell Microsoft](https://learn.microsoft.com/fr-fr/powershell/scripting/install/installing-powershell-on-windows?view=powershell-7.5).
2. Exécuter le fichier MSI → suivre les étapes.
3. Cocher « Add ‘Open here’ context menus to Explorer » pour les menus contextuels.
4. Lancer PowerShell (idéalement en **mode administrateur**).

#### **Sous Linux Ubuntu**

1. Configurer le mot de passe **sudo** si nécessaire :

```bash
sudo passwd
```

2. Mettre à jour le système :

```bash
sudo apt-get update
```

3. Télécharger le package Microsoft :

```bash
cd /tmp
wget -q https://packages.microsoft.com/config/ubuntu/18.04/packages-microsoft-prod.deb
sudo apt-get install ./packages-microsoft-prod.deb
```

4. Installer PowerShell :

```bash
sudo apt install powershell
```

5. Vérifier installation :

```bash
pwsh --version
pwsh
```

---

### **4. Structure d’une commande PowerShell**

* Format : **Verbe-Nom** (ex. `Get-EventLog`)
* Paramètres :

  * Valeurs simples : `LogName Security`
  * Valeurs multiples : `ComputerName WIN10,SERVER2`
  * Paramètres de commutation : `-Verbose`

---

### **5. 10 commandes essentielles**

| Commande              | Description                                       | Exemple                                               |                                                          |
| --------------------- | ------------------------------------------------- | ----------------------------------------------------- | -------------------------------------------------------- |
| `Get-Help`            | Obtenir l’aide sur une cmdlet                     | `Get-Help -Name Get-EventLog`                         |                                                          |
| `Get-Command`         | Liste les commandes disponibles                   | `Get-Command *-Service*`                              |                                                          |
| `Get-Service`         | Affiche les services Windows                      | `Get-Service -Name WSearch`                           |                                                          |
| `Get-Process`         | Affiche les processus en cours                    | `Get-Process`                                         |                                                          |
| `Set-ExecutionPolicy` | Gérer la politique d’exécution (sécurité)         | `Set-ExecutionPolicy Restricted`                      |                                                          |
| `Get-ExecutionPolicy` | Vérifier la politique d’exécution                 | `Get-ExecutionPolicy`                                 |                                                          |
| `Start-Service`       | Démarrer un service                               | `Start-Service -Name WSearch`                         |                                                          |
| `Start-Process`       | Démarrer un processus                             | `Start-Process chrome`                                |                                                          |
| `Stop-Process`        | Arrêter un processus                              | `Stop-Process -Name chrome` ou `Stop-Process -ID 640` |                                                          |
| `ConvertTo-HTML`      | Exporter la sortie d’une commande en rapport HTML | `Get-Process                                          | ConvertTo-HTML -Property Name,Status > C:\processes.htm` |

---

### **6. Sécurité et bonnes pratiques**

* Par défaut, l’exécution de scripts est **restreinte** (`Restricted`).
* Autres niveaux : `Unrestricted`, `AllSigned`, `RemoteSigned`.
* Lancer PowerShell **en tant qu’administrateur** pour certaines commandes.
* Utiliser PowerShell Remoting pour la gestion à distance des systèmes.

---

### **Résumé**

* PowerShell = outil incontournable pour **l’automatisation et la gestion de Windows**.
* Disponible maintenant sur **Windows et Linux**.
* Vérification de l’installation, mise à jour et configuration sudo indispensables.
* 10 cmdlets de base = fondation pour tout administrateur.

---