# **PowerShell : Création du premier script**

## **Objectif**

Apprendre à créer et exécuter un script PowerShell simple permettant de :

* Interagir avec l’utilisateur
* Afficher la date et l’heure
* Lancer un site web via le navigateur par défaut

---

## **Concepts clés**

### **1. Variables d’environnement**

* Stockent des informations dynamiques sur le système et les processus.
* Sensibles à la casse (ex : `PATH` ≠ `path`).
* Héritage : les variables d’environnement peuvent être transmises aux processus enfants.
* Commandes d’affichage :

  * **Windows** : `set`
  * **Linux** : `env`

---

### **2. Préparation de l’environnement**

1. Ouvrir **PowerShell en administrateur**.
2. Se déplacer dans le dossier Documents :

```powershell
cd .\Users\VotreNomDUtilisateur\Documents\
```

3. Créer un dossier pour les scripts :

```powershell
mkdir "Scripts"
cd .\Scripts\
```

4. Créer le fichier script :

```powershell
New-Item -Name "script.ps1"
```

5. Ouvrir PowerShell ISE pour éditer le script (ou un autre éditeur).

---

### **3. Création du script**

**Objectif du script :** demander à l’utilisateur s’il souhaite ouvrir Google, afficher la date/heure et lancer le navigateur.

**Code complet :**

```powershell
$input = Read-Host -Prompt "Voulez vous ouvrir google.com ? (Y/N)"

if(($input -eq "y")){
    echo "Vous avez ouvert la page le : "
    Get-Date
    [System.Diagnostics.Process]::Start("https://www.google.com")
}else{
    echo "Une prochaine fois !"
}
```

**Explications :**

* `Read-Host -Prompt` : demande une saisie utilisateur.
* `if(($input -eq "y")){}` : condition si l’utilisateur tape "y".
* `echo` : affiche un message dans le prompt.
* `Get-Date` : affiche la date et l’heure.
* `[System.Diagnostics.Process]::Start()` : ouvre un site web dans le navigateur par défaut.
* `else{}` : message alternatif si l’utilisateur tape autre chose que "y".

---

### **4. Test du script**

1. Sauvegarder le script.
2. Lancer la **transcription** pour enregistrer la session :

```powershell
Start-Transcript
```

3. Exécuter le script :

```powershell
.\script.ps1
```

4. Tester les deux cas :

   * `Y` → Google s’ouvre + affichage de la date/heure.
   * `N` → affichage du message alternatif.
5. Arrêter la transcription :

```powershell
Stop-Transcript
```

6. Consulter le fichier de transcription dans le dossier Documents.

---

### **5. Essentiel**

* PowerShell est un outil puissant pour **l’automatisation et la gestion réseau**.
* Les scripts permettent d’interagir avec l’utilisateur et d’exécuter des commandes système.
* Ce premier script illustre les bases : saisie utilisateur, conditions, affichage, lancement d’application.

---