# **PowerShell – Adaptation et amélioration de scripts**

## **Objectif**

Savoir modifier un script PowerShell existant pour le rendre plus complet, lisible et maintenable, en utilisant des structures logiques comme `if/else` ou `switch`.

---

## **Concepts clés**

### **1. Base : Script interactif d’addition**

* Nettoyage de la console :

```powershell
Clear-Host
```

* Affichage d’un texte :

```powershell
Write-Host "Texte à afficher"
```

* Pause et attente de l’utilisateur :

```powershell
Read-Host
```

* Lecture de l’entrée utilisateur :

```powershell
$valeur1 = Read-Host "Entrez la valeur 1"
$valeur2 = Read-Host "Entrez la valeur 2"
```

* Conversion en entier et calcul :

```powershell
[int]$valeur1 + [int]$valeur2
```

---

### **2. Ajout de la soustraction**

* Définir l’opérateur :

```powershell
$operateur = Read-Host "Entrez l'opérateur de calcul (+ ou -)"
```

* Utiliser `if/else` pour choisir l’opération :

```powershell
if($operateur -eq "+") {
    [int]$valeur1 + [int]$valeur2
} elseif($operateur -eq "-") {
    [int]$valeur1 - [int]$valeur2
} else {
    Write-Host "Opérateur incorrect"
}
```

---

### **3. Passage à `switch` pour plus de lisibilité**

* Le `switch` permet de simplifier les conditions multiples et d’éviter l’imbrication de `if/else`.
  Exemple :

```powershell
switch($operateur){
   "+" {
       Write-Host "Addition des valeurs :"
       [int]$valeur1 + [int]$valeur2
   }
   "-" {
       Write-Host "Soustraction des valeurs :"
       [int]$valeur1 - [int]$valeur2
   }
   default {
       Write-Host "Opérateur incorrect"
   }
}
```

---

### **4. Bonnes pratiques**

* **Indentation** : facilite la lecture et la maintenance du code.
* **Clarté** : afficher des instructions claires pour l’utilisateur.
* **Simplicité** : un code plus court et structuré est plus facile à comprendre.
* **Modularité** : prévoir la possibilité d’ajouter d’autres opérations (multiplication, division) en étendant le `switch`.
* **Consistance** : garder les mêmes conventions pour les noms de variables et la structure du script.

---

### **5. Essentiel à retenir**

1. `Clear-Host` → nettoyer la console
2. `Write-Host` → afficher des messages
3. `Read-Host` → demander une entrée utilisateur
4. Conversion de type : `[int]$variable` pour les calculs
5. `if/else` → choix conditionnel simple
6. `switch` → choix conditionnel multiple et plus lisible
7. Toujours penser à l’**indentation** et à la **clarté** pour faciliter la maintenance du script

---