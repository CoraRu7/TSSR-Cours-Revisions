### **Titre : Configuration et gestion d’un IDS/IPS**

**Objectif :**
Comprendre la mise à jour des signatures, la surveillance des alertes, la journalisation des événements et l’analyse post-mortem pour assurer l’efficacité et la sécurité des IDS/IPS sur un réseau.

---

### **Concepts clés :**

**I) Gestion des mises à jour des signatures**

* **Définition d’une signature** : processus cryptographique assurant l’authenticité et l’intégrité d’un message ou fichier via clé privée/publique.
* **Rôle des IDS et IPS** :

  * IDS : analyse et détecte les menaces sur le réseau.
  * IPS : bloque ou rejette les paquets en cas de menace.
* **Importance des mises à jour** :

  * Base de données des signatures toujours à jour pour détecter les nouvelles attaques.
  * Automatisation des mises à jour recommandée, vérification manuelle régulière.
* **Exemple pratique : Suricata**

  * Installation :

    ```bash
    tar xzvf suricata-6.0.0.tar.gz
    cd suricata-6.0.0
    ./configure
    make
    make install
    ```
  * Gestion des règles : ajout et mise à jour via `suricata-update`.
  * Attention : tri et configuration des alertes pour limiter les faux positifs.
* **Paramètres manuels** : ajouter des signatures non reconnues pour créer des exceptions et tester via une attaque simulée.

---

**II) Surveillance et analyse des alertes**

* **Configuration des notifications** : email, SMS, ou logiciel de supervision selon IDS ou IPS.
* **Consultation des logs** :

  * Contiennent adresses IP, fichiers échangés, date/heure.
  * Centralisation et journalisation essentielles pour analyse et sécurité.
  * Utilisation possible de SIEM pour collecte et analyse avancée.
* **Tri et hiérarchisation des alertes** :

  * Définir seuil d’alerte pour déclencher notification seulement si nécessaire.
  * Niveaux de gravité :

    * Niveau 1 : critique
    * Niveau 2 : majeur
    * Niveau 3 : mineur
  * Différencier gravité (impact) et priorité (délai d’intervention).
* **Actions selon type d’alerte** :

  * IPS : vérifier actions automatiques ou manuelles.
  * IDS : analyser alertes, assigner gravité, bloquer si nécessaire, enregistrer actions.

---

**III) Rapports et journalisation des événements**

* **Journalisation** : centralisation des événements pour consultation rapide et gestion efficace.
* **Génération de rapports** :

  * Historique des alertes et événements.
  * Identification de tendances, anomalies, vulnérabilités.
  * Conformité aux normes et régulations (CIS Niveau 1 et 2).
* **Analyse post-mortem** :

  * Après incident, documenter nature, date, conséquences, actions correctives.
  * Objectif : éviter répétition des incidents et améliorer sécurité.

---

### **Commandes / Notes pratiques :**

* Suricata installation : `tar xzvf`, `./configure`, `make`, `make install`
* Mise à jour signatures : `suricata-update`
* Configuration alertes : seuils, niveaux de gravité, notifications
* Analyse post-mortem : collecter logs, événements, actions, recommandations

---

### **Liens utiles / références :**

* Suricata : [https://suricata-ids.org](https://suricata-ids.org)
* CIS : [https://www.cisecurity.org](https://www.cisecurity.org)
* CrowdStrike exemples de logs : [https://www.crowdstrike.com](https://www.crowdstrike.com)

---