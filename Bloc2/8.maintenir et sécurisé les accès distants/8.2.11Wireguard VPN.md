## üßæ **Titre : Installer et param√©trer une solution VPN WireGuard (H√¥te et Client)**

### üéØ **Objectif :**

Savoir installer, configurer et tester un tunnel VPN s√©curis√© entre une machine h√¥te et une machine client avec **WireGuard**, en chiffrant les donn√©es et en assurant la connectivit√©.

---

### üß† **Concepts cl√©s :**

* **WireGuard** : solution VPN moderne, simple, rapide et s√©curis√©e.
* **Tunnel virtuel s√©curis√©** : crypte les donn√©es transitant entre deux machines pour garantir confidentialit√© et int√©grit√©.
* **H√¥te (serveur) et Client** : architecture client-serveur pour √©tablir le tunnel VPN.
* **Redirection de port** : n√©cessaire si le serveur est derri√®re une box/routeur.
* Les interfaces r√©seau virtuelles (wg0) permettent de relier le VPN aux interfaces physiques et de g√©rer le trafic chiffr√©.

---

### üíª **Commandes & Notes :**

#### 1Ô∏è‚É£ Configuration de l‚Äôh√¥te (serveur Ubuntu)

* √âditer le fichier de configuration :

```bash
nano /etc/wireguard/wg0.conf
```

* Ajouter le peer (client) :

```
[Peer]
PublicKey = <cl√© publique du client>
AllowedIPs = 192.168.1.174/32
```

* Configurer le routage et le NAT :

```
PostUp = iptables -A FORWARD -i %i -j ACCEPT; iptables -A FORWARD -o %i -j ACCEPT; iptables -t nat -A POSTROUTING -o enp0s3 -j MASQUERADE
PostDown = iptables -D FORWARD -i %i -j ACCEPT; iptables -D FORWARD -o %i -j ACCEPT; iptables -t nat -D POSTROUTING -o enp0s3 -j MASQUERADE
```

* Red√©marrer l‚Äôinterface VPN :

```bash
wg-quick down wg0
wg-quick up wg0
```

#### 2Ô∏è‚É£ Configuration du client

* √âditer le fichier de configuration du client :

```
[Peer]
PublicKey = <cl√© publique du serveur>
AllowedIPs = <IP VPN du serveur>
Endpoint = <IP publique du serveur>:51820
```

* V√©rifier la connexion VPN et le tunnel s√©curis√©.

#### 3Ô∏è‚É£ Redirection des ports sur la box/routeur

* Port utilis√© par WireGuard : **51820/UDP**
* Configurer la redirection sur la box :

  * IP destination : IP du serveur
  * Protocole : UDP
  * Port source & destination : 51820
  * Activer la redirection

#### 4Ô∏è‚É£ Tester la communication

* Ping entre h√¥te et client via IP VPN :

```bash
ping 192.168.x.x
```

* Tester l‚Äôacc√®s √† un serveur web install√© sur l‚Äôh√¥te :

```bash
apt-get install apache2  # sur le serveur
```

* Depuis le client, acc√©der √† la page via navigateur avec l‚ÄôIP VPN de l‚Äôh√¥te.

---

### ‚ö†Ô∏è **Essentiel √† retenir :**

* Les **interfaces virtuelles** doivent √™tre configur√©es sur l‚Äôh√¥te et le client.
* La **cr√©ation du tunnel VPN** est obligatoire pour le chiffrement des donn√©es.
* Une **redirection de port** sur la box est n√©cessaire pour permettre les connexions via Internet.
* WireGuard affiche automatiquement l‚Äô√©tat des connexions sur le client.

---

### üîó **Liens utiles :**

* [Documentation officielle WireGuard](https://www.wireguard.com/)
* [Guide Ubuntu ‚Äì Configuration WireGuard](https://help.ubuntu.com/community/WireGuard)
* [Tutoriel VPN Linux](https://www.linux.com/tutorials/how-set-wireguard-vpn-linux/)

---