# **Déployer un pare-feu : pfSense**

## **Contexte**

* Objectif : découvrir l’utilisation d’un **pare-feu en entreprise** avec pfSense.
* Fonctions principales :

  * Configuration de **règles de filtrage**
  * Connexion de réseaux distants via **VPN (IPSec, OpenVPN, etc.)**
  * NAT, redirection de port, proxy, surveillance du trafic

---

## **I) Présentation de pfSense**

### **1. Qu’est-ce qu’un pare-feu ?**

* Dispositif de sécurité qui **contrôle le trafic réseau** entrant et sortant.
* Fonction : protéger contre les **accès non autorisés, virus et attaques malveillantes**.
* Peut être : logiciel, matériel ou mix des deux.
* Basé sur des **règles** : autoriser ou bloquer selon IP, port, protocole, etc.
* Exemple : autoriser un PC admin (192.168.1.10/24) à accéder à un serveur (192.168.2.100/24) via SSH (port 22).

### **2. pfSense**

* **OS open source** basé sur FreeBSD, créé en 2004 par Chris Buechler et Scott Ullrich.
* Rôles : **pare-feu, routeur, passerelle VPN**.
* Administration : **interface web** ou SSH (ex. Putty).
* Fonctionnalités :

  * Filtrage de paquets avancé
  * NAT et redirection de port
  * VPN (OpenVPN, IPsec)
  * Proxy et contrôle web
  * Surveillance du trafic et statistiques en temps réel
  * Extensions via packages pour fonctionnalités supplémentaires
* Avantages : **flexible, gratuit, adapté aux réseaux domestiques et entreprises**

---

## **II) Installation de pfSense**

### **Méthode**

1. Télécharger l’ISO pfSense (64 bits).
2. Créer une machine virtuelle sur **Hyper-V** ou **VirtualBox**.
3. Monter l’ISO sur la VM et démarrer l’installation.

### **Assignation des interfaces**

* WAN : interface connectée au réseau NAT (ex. en0, em0)
* LAN : interface réseau privé hôte (ex. en1)
* Vérifier les adresses MAC pour confirmer les interfaces.

### **Configuration des interfaces**

* Menu pfSense :

  1. **Assign Interfaces** → définir LAN/WAN
  2. **Set Interface IP address** → attribuer adresses IP aux interfaces

* Connexion à l’interface web LAN :

  * Client dans le même réseau LAN
  * Login/Mot de passe par défaut : `admin/pfsense`
  * Configurer nom, domaine, fuseau horaire et changer le mot de passe admin

---

## **III) Configuration des règles de pare-feu**

### **Rappel des règles**

* Permettent ou bloquent le trafic selon :

  * IP source/destination
  * Ports et protocoles (TCP, UDP, ICMP…)
* Comportement :

  * Paquet correspondant à une règle autorisée → passe
  * Paquet correspondant à une règle bloquée → rejeté
  * Sinon → applique la **règle par défaut** (souvent bloquer)

### **Exemple de règle**

* Bloquer les pings ICMP sortants :

  ```
  Firewall → Rules → LAN
  Action : Block
  Interface : LAN
  Protocol : ICMP
  Source : any
  Destination : any
  Logging : enabled
  Save & Apply
  ```

---

## **IV) Points clés**

* pfSense est :

  * **Open source et gratuit**
  * **Flexible** et extensible avec packages
  * Convient aux réseaux **domestiques et professionnels**
  * Offre **interface web** conviviale pour administration
* Fonctions principales :

  * Pare-feu (filtrage, NAT, redirection)
  * VPN (OpenVPN, IPsec)
  * Surveillance et statistiques du réseau

