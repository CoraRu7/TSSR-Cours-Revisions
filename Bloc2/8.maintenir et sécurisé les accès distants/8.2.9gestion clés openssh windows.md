# üîê **Titre : Gestion des cl√©s OpenSSH sous Windows**

---

## üéØ **Objectif**

Comprendre le r√¥le des cl√©s SSH, apprendre √† g√©n√©rer une paire de cl√©s (publique/priv√©e) sous Windows avec OpenSSH et √† s√©curiser les cl√©s priv√©es pour une authentification distante sans mot de passe.

---

## üß† **Concepts cl√©s**

* **SSH (Secure Shell)** : protocole de communication s√©curis√©e pour acc√©der √† un h√¥te distant.
* **Cl√©s SSH** : syst√®me d‚Äôauthentification bas√© sur une **cl√© publique** (plac√©e sur le serveur) et une **cl√© priv√©e** (gard√©e secr√®te sur le client).
* **Authentification sans mot de passe** : apr√®s configuration, permet une connexion automatique et chiffr√©e.
* **OpenSSH sous Windows** : int√©gr√© nativement depuis la mise √† jour 2018 de Windows 10.
* **ssh-agent** : service Windows qui g√®re et stocke les cl√©s priv√©es de mani√®re s√©curis√©e.

---

## ‚öôÔ∏è **Commandes et notes**

### üß© **V√©rification / Installation du client OpenSSH**

1. Aller dans :

   ```
   D√©marrer ‚Üí Param√®tres ‚Üí Syst√®me ‚Üí Fonctionnalit√©s facultatives
   ```

   ‚Üí V√©rifier si **OpenSSH Client** est install√©.

2. Si non install√© :

   * Cliquer sur **Ajouter une fonctionnalit√©**
   * S√©lectionner **OpenSSH Client**
   * Red√©marrer le PC apr√®s installation.

---

### üß∞ **G√©n√©ration d‚Äôune paire de cl√©s SSH**

1. **Ouvrir PowerShell (en administrateur)**

   ```bash
   ssh-keygen -t ed25519
   ```

   > G√©n√®re une cl√© priv√©e (`id_ed25519`) et une cl√© publique (`id_ed25519.pub`)

2. **Emplacement par d√©faut :**

   ```
   C:\Users\<nom_utilisateur>\.ssh\
   ```

3. **Ajouter une passphrase (optionnel mais recommand√©)**

   > Exemple : `studitest`
   > La passphrase prot√®ge la cl√© priv√©e localement.

4. **Lister les cl√©s g√©n√©r√©es :**

   ```bash
   ls .ssh
   ```

   > V√©rifie la pr√©sence des deux fichiers : cl√© publique et cl√© priv√©e.

---

### üîí **Protection et gestion des cl√©s priv√©es**

#### 1Ô∏è‚É£ Activer le service ssh-agent

```bash
Get-Service ssh-agent | Set-Service -StartupType Manual
```

> Permet de lancer manuellement le service de gestion des cl√©s SSH.

#### 2Ô∏è‚É£ D√©marrer le service ssh-agent

```bash
Start-Service ssh-agent
```

#### 3Ô∏è‚É£ V√©rifier son √©tat

```bash
Get-Service ssh-agent
```

> L‚Äô√©tat doit √™tre **Running** (en cours d‚Äôex√©cution).

#### 4Ô∏è‚É£ Ajouter la cl√© priv√©e au ssh-agent

```bash
ssh-add C:\Users\<nom_utilisateur>\.ssh\id_ed25519
```

> Le syst√®me demandera la passphrase d√©finie lors de la g√©n√©ration.
> Une fois ajout√©e, la cl√© est charg√©e dans l‚Äôagent pour les connexions SSH.

---

## üß± **Fonctionnement g√©n√©ral**

| √âl√©ment          | Description                                                                         |
| ---------------- | ----------------------------------------------------------------------------------- |
| **Cl√© publique** | Plac√©e sur le serveur distant, utilis√©e pour chiffrer la connexion.                 |
| **Cl√© priv√©e**   | Conserv√©e localement, permet de s‚Äôauthentifier sans mot de passe.                   |
| **ssh-agent**    | Service Windows qui stocke les cl√©s priv√©es et g√®re l‚Äôauthentification automatique. |

---

## üß† **Rappels importants**

* Ne jamais partager sa **cl√© priv√©e**.
* Toujours prot√©ger sa cl√© avec une **passphrase**.
* V√©rifier que les **permissions du dossier .ssh** emp√™chent tout acc√®s non autoris√©.
* En cas de probl√®me, supprimer et r√©g√©n√©rer la paire de cl√©s.

---

## üîó **Liens utiles**

* [Documentation OpenSSH Microsoft](https://learn.microsoft.com/fr-fr/windows-server/administration/openssh/openssh_overview)
* [Guide GitHub sur les cl√©s SSH](https://docs.github.com/fr/authentication/connecting-to-github-with-ssh)

---