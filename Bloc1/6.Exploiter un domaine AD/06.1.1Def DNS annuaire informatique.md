
# Fiches de rÃ©vision â€” DNS & Annuaire (LDAP / Active Directory)

<details>
<summary>

## ğŸ“˜ Fiche 1 â€” Objectif & notions gÃ©nÃ©rales
</summary>

### ğŸ¯ Objectif
Comprendre le rÃ´le du **DNS** (Domain Name System) et de lâ€™**annuaire informatique** (ex. LDAP / Active Directory), leurs interactions, et maÃ®triser les commandes et procÃ©dures de base pour administrer la rÃ©solution de noms et les annuaires dans un domaine Active Directory.

---

### ğŸ§  Concepts clÃ©s (synthÃ¨se)
- **DNS** : service qui traduit un nom de domaine lisible (ex. `exemple.com`) en adresse IP (ex. `192.0.2.1`) et inversement.  
- **Annuaire informatique / LDAP** : base hiÃ©rarchique (utilisateurs, groupes, ordinateurs) consultable via le protocole LDAP ; Active Directory (AD) est une implÃ©mentation courante.  
- **RÃ©solveur rÃ©cursif (resolver)** : reÃ§oit la requÃªte du client et effectue les recherches nÃ©cessaires.  
- **Serveur racine â†’ TLD â†’ Serveur faisant autoritÃ©** : chaÃ®ne standard de rÃ©solution DNS.  
- **Zones DNS** : zones de recherche directe (A, AAAA, MX, CNAME) et zones inverses (PTR).  
- **DNS dynamique (DDNS)** : mise Ã  jour automatique des enregistrements lorsque lâ€™IP change.  
- **DNSSEC** : extension de sÃ©curitÃ© assurant lâ€™authenticitÃ© des rÃ©ponses DNS.  
- **rDNS (reverse DNS)** : rÃ©solution IP â†’ nom (PTR).

---
</details>
<details>
<summary>

## ğŸ§© Fiche 2 â€” DÃ©finitions utiles
</summary>

- **TLD (Top Level Domain)** : `.com`, `.fr`, etc.  
- **gTLD / ccTLD** : gÃ©nÃ©rique / pays.  
- **Resolver** : client DNS cÃ´tÃ© rÃ©seau (souvent fourni par le FAI ou par un DNS interne).  
- **Zone faisant autoritÃ©** : serveur DNS qui dÃ©tient les enregistrements rÃ©els dâ€™un domaine.  
- **SOA (Start Of Authority)** : enregistrement qui contient les mÃ©tadonnÃ©es dâ€™une zone (TTL, serial, refresh...).  
- **NTDS.dit** : fichier base AD contenant les objets de lâ€™annuaire.  
- **DSRM (Directory Services Restore Mode)** : mode de dÃ©marrage spÃ©cial pour restaurer AD.

---
</details>
<details>
<summary>

## âš™ï¸ Fiche 3 â€” Commandes et outils essentiels
</summary>

### Commandes DNS (Windows)
- `nslookup <nom>` â†’ tester la rÃ©solution de nom.  
- `nslookup <ip>` â†’ reverse lookup (rDNS).  
- `ipconfig /displaydns` â†’ afficher le cache DNS local.  
- `ipconfig /flushdns` â†’ vider le cache DNS local.  
- **Outils GUI** : **DNS Manager** (Outils â†’ DNS) sous Windows Server.

### Commandes DNS (Linux / cross-platform)
- `dig exemple.com` â†’ requÃªte DNS dÃ©taillÃ©e.  
- `dig -x 192.0.2.1` â†’ reverse lookup.  
- `dig @serveur exemple.com AXFR` â†’ tentative de transfert de zone (AXFR).

### Commandes AD / LDAP (Windows)
- `dsquery user -name <pattern>` â†’ rechercher des utilisateurs (legacy).  
- `dsget user <DN>` â†’ rÃ©cupÃ©rer info utilisateur.  
- PowerShell (Recommended) :
  - `Get-ADUser -Identity jdupont`  
  - `Get-DnsServerResourceRecord -ZoneName "exemple.local"`  
  - `Add-DnsServerPrimaryZone -Name "exemple.local" -ReplicationScope "Domain"`

### Sauvegarde / Diagnostic
- `nltest /dsgetdc:<domain>` â†’ trouver DC.  
- `repadmin /replsummary` â†’ Ã©tat rÃ©plication AD.  
- `dcdiag` â†’ diagnostic contrÃ´leur de domaine.

---
</details>
<details>
<summary>

## ğŸ› ï¸ Fiche 4 â€” MÃ©thodes / procÃ©dures courantes
</summary>

### A â€” RÃ©solution DNS (processus simplifiÃ©)
1. Le client interroge son **rÃ©solveur rÃ©cursif** local (ex. DNS du FAI ou interne).  
2. Si le rÃ©solveur nâ€™a pas la rÃ©ponse en cache, il interroge un **serveur racine** â†’ obtient lâ€™adresse du TLD.  
3. Le rÃ©solveur interroge le **serveur TLD** â†’ obtient le serveur faisant autoritÃ© pour le domaine.  
4. Le rÃ©solveur interroge le **serveur faisant autoritÃ©** â†’ obtient lâ€™enregistrement A/AAAA (ou PTR pour rDNS).  
5. Le rÃ©solveur renvoie lâ€™IP au client (mise en cache selon TTL).

### B â€” CrÃ©er une zone DNS (Windows Server â€” rÃ©sumÃ©)
1. Ouvrir **DNS Manager** (Outils â†’ DNS).  
2. Clic droit sur **Forward Lookup Zones** â†’ **New Zoneâ€¦**.  
3. Choisir type (Primary / AD-integrated).  
4. Nommer la zone (ex. `exemple.local`) et configurer la rÃ©plication si AD-integrÃ©.  
5. Ajouter enregistrements : **A** (host), **PTR** (reverse), **MX**, **CNAME**, etc.

### C â€” Tester une zone / enregistrement
- Windows : `nslookup test.exemple.local` ou `nslookup 192.168.1.45`  
- Linux : `dig test.exemple.local` / `dig -x 192.168.1.45`  
- VÃ©rifier SOA : `nslookup -type=soa exemple.local` ou `dig SOA exemple.local`

### D â€” LDAP / AD â€” rechercher un utilisateur (PowerShell)
```powershell
Import-Module ActiveDirectory
Get-ADUser -Filter 'Name -like "*Dupont*"' -Properties SamAccountName,EmailAddress
````
</details>
<details>
<summary>

## ğŸ”Œ Fiche 5 â€” Protocoles & ports (rapide)
</summary>

| Service                  | Protocole |               Port               |
| :----------------------- | :-------- | :------------------------------: |
| DNS (query)              | UDP/TCP   |                53                |
| DNS zone transfer (AXFR) | TCP       |                53                |
| LDAP                     | TCP/UDP   |                389               |
| LDAPS (LDAP over TLS)    | TCP       |                636               |
| Kerberos                 | TCP/UDP   |                88                |
| RPC / AD replication     | TCP       | *divers (ex. 135 + dynamic RPC)* |
| HTTP/HTTPS (web)         | TCP       |             80 / 443             |

---
</details>
<details>
<summary>

## âš ï¸ Fiche 6 â€” Points de vigilance & bonnes pratiques
</summary>

* **SÃ©curiser DNS** :

  * Activer **DNSSEC** sur les zones publiques pour prÃ©venir le cache poisoning.
  * Restreindre les transferts de zone (AXFR) aux serveurs autorisÃ©s.
  * Surveiller les logs DNS pour dÃ©tection dâ€™anomalies (bcp de requÃªtes, requÃªtes inhabituelles).
* **SÃ©curitÃ© LDAP / AD** :

  * Forcer LDAPS (chiffrement TLS) pour Ã©viter la fuite de credentials en clair.
  * Limiter les droits dâ€™Ã©criture sur les objets sensibles ; auditer les modifications.
* **Haute disponibilitÃ©** :

  * DÃ©ployer plusieurs contrÃ´leurs de domaine et serveurs DNS (rÃ©plication).
  * RÃ©plication AD configurÃ©e et testÃ©e (`repadmin`, `dcdiag`).
* **TTL & cache** :

  * Choisir un TTL adaptÃ© : trop court â†’ charge; trop long â†’ lenteur des corrections.
  * AprÃ¨s modification DNS critique, vider caches locaux (`ipconfig /flushdns`) et prÃ©venir les caches intermÃ©diaires si possible.
* **Reverse DNS (PTR)** :

  * Toujours configurer PTR pour IP publiques (ex. serveurs mail), sinon risque de blocage par anti-spam.
* **DNS dynamique (DDNS)** :

  * ContrÃ´ler qui peut mettre Ã  jour : Ã©viter mises Ã  jour non autorisÃ©es.
* **Surveillance et alerting** :

  * Mettre en place monitoring (rÃ©solution, latence, taux dâ€™Ã©chec) et alertes.

---
</details>
<details>
<summary>

## ğŸ”— Fiche 7 â€” Liens & ressources utiles
</summary>

* Commandes utiles : `nslookup`, `dig`, `ipconfig`, PowerShell `Get-DnsServer*`.
* Outils GUI Windows : **DNS Manager**, **Active Directory Users and Computers**.
* Concepts Ã  approfondir : **DNSSEC**, **AXFR/IXFR (zone transfer)**, **DDNS**, **LDAPS**, **Kerberos**.
* Docs Microsoft : recherche Â« DNS Server Â» et Â« Active Directory Domain Services Â» sur Microsoft Learn.

---
</details>
<details>
<summary>

## âœ… RÃ©sumÃ© (1 phrase)
</summary>

Le **DNS** rend les noms lisibles et lâ€™Internet utilisable ; lâ€™**annuaire (LDAP / AD)** organise et sÃ©curise les identitÃ©s et ressources du domaine â€” bien configurer et sÃ©curiser lâ€™un et lâ€™autre (rÃ©solution, rÃ©plication, chiffrement, sauvegarde) est indispensable pour un domaine Active Directory fiable.

---
</details>

