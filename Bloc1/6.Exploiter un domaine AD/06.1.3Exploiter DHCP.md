# Fiche de rÃ©vision â€” Exploiter le DHCP (dÃ©tails calculs inclus)

---

## ğŸ¯ Objectif
Comprendre le DHCP, savoir installer/configurer un serveur sous Windows Server, gÃ©rer Ã©tendues, exclusions, rÃ©servations et filtres, et calculer rapidement les adresses IP disponibles dans un rÃ©seau.

---
<details>
<summary>

## ğŸ§  Concepts clÃ©s
</summary>

- **DHCP** : protocole client-serveur pour lâ€™attribution automatique des paramÃ¨tres rÃ©seau.
- **Adressage statique vs dynamique** : manuel vs DHCP.
- **Ports UDP** : 67 (serveur), 68 (client)
- **Cycle DORA** :
  1. **Discover** â†’ broadcast client pour trouver un serveur DHCP
  2. **Offer** â†’ serveur propose une IP
  3. **Request** â†’ client sÃ©lectionne une offre
  4. **ACK** â†’ serveur confirme l'IP au client
 ```bash
  [Client]                               [Serveur DHCP]
  |--DISCOVER--------------------------->|
  |<--OFFER ---------------------------->|
  |--REQUEST---------------------------->|
  |<--ACK--------------------------------|
  |                                       
  DHCP attribue IP dyn. ou rÃ©servÃ©e
```


- **Ã‰tendue (Scope)** : plage dâ€™adresses IP Ã  distribuer.
- **Exclusions** : adresses Ã  ne pas distribuer.
- **RÃ©servation** : garantir quâ€™un client obtienne toujours la mÃªme IP.
 ```bash
[Serveur DHCP]
    |
    |---Baux d'adresses
           |
           |---192.168.56.10 â†’ PC-Bureau1 (MAC: AA-BB-CC-DD-EE-FF)
                  |
                  +--> RÃ©servation
                        |
                        +--> IP fixe via DHCP
```
- **Filtres MAC** : autoriser ou exclure des clients.
- **APIPA** : 169.254.0.0/16 si DHCP indisponible.

---
</details>
<details>
<summary>

## âš™ï¸ Notions rÃ©seau & calculs IP
</summary>

### 1ï¸âƒ£ Adresse IP et masque
- Adresse IPv4 = 4 octets (32 bits). Exemple : `192.168.10.20`
- Masque : sÃ©pare **partie rÃ©seau** et **partie hÃ´tes**.
  - Exemple `/24` â†’ 255.255.255.0
  - Les 24 bits Ã  1 â†’ rÃ©seau, 8 bits Ã  0 â†’ hÃ´tes.

### 2ï¸âƒ£ Classes dâ€™adresses
| Classe | Plage IP | PrivÃ©e ? |
|--------|----------|----------|
| A      | 0.0.0.0 â†’ 126.255.255.255 | 10.0.0.0 â†’ 10.255.255.255 |
| B      | 128.0.0.0 â†’ 191.255.255.255 | 172.16.0.0 â†’ 172.31.255.255 |
| C      | 192.0.0.0 â†’ 223.255.255.255 | 192.168.0.0 â†’ 192.168.255.255 |

### 3ï¸âƒ£ Calcul du nombre dâ€™adresses utilisables
Formule :  
```

Nombre dâ€™IP utilisables = 2^n - 2

```
- `n` = nombre de bits Ã  0 dans le masque  
- Exemple : rÃ©seau `192.168.10.0/24`  
  - Masque /24 â†’ 32-24 = 8 bits pour les hÃ´tes â†’ 2^8 - 2 = 254 IP utilisables.  
  - Adresses importantes :  
    - Adresse rÃ©seau : 192.168.10.0  
    - 1re IP utilisable : 192.168.10.1 (souvent passerelle)  
    - DerniÃ¨re IP utilisable : 192.168.10.254  
    - Broadcast : 192.168.10.255  

- Exemple rÃ©seau `/26` â†’ masque 255.255.255.192 â†’ 6 bits pour hÃ´tes : 2^6-2 = 62 IP utilisables.  

### 4ï¸âƒ£ Ã‰tendue DHCP
- Plage dâ€™adresses : dÃ©but â†’ fin
- Exemple : 192.168.56.10 â†’ 192.168.56.30  
- Masque = 255.255.255.0 (/24) â†’ 21 adresses possibles (10 â†’ 30 inclus)

### 5ï¸âƒ£ Planification VLAN
- VLAN PC : 192.168.10.0/24 â†’ 192.168.10.10 â†’ 192.168.10.200  
- VLAN WiFi invitÃ© : 192.168.20.0/24 â†’ 192.168.20.10 â†’ 192.168.20.254  

---
</details>
<details>
<summary>

## ğŸ› ï¸ Installation et configuration DHCP
</summary>

### 1ï¸âƒ£ Installation du rÃ´le (Windows Server)
- Gestionnaire de serveur â†’ Ajouter rÃ´le â†’ Serveur DHCP â†’ installer  
- Configurer IP statique avant lâ€™installation  
- Valider configuration post-installation (groupes sÃ©curitÃ©â€¦)

### 2ï¸âƒ£ CrÃ©ation dâ€™une Ã©tendue (GUI)
1. Console DHCP â†’ clic droit IPv4 â†’ Nouvelle Ã©tendue  
2. Nom + description â†’ Suivant  
3. Plage IP dÃ©but/fin + masque â†’ Suivant  
4. Exclusions â†’ Suivant  
5. DurÃ©e du bail â†’ Suivant (8 jours par dÃ©faut)  
6. Options DHCP â†’ passerelle, DNS, WINS â†’ Suivant  
7. Activer lâ€™Ã©tendue â†’ Terminer

### 3ï¸âƒ£ RÃ©servations et filtres
- **RÃ©servation** : lier IP Ã  MAC  
- **Filtres** : autoriser/exclure MAC, gÃ©rer APIPA en cas de blocage  
- Tester avec `ipconfig /release` puis `/renew` sur le client

---
</details>
<details>
<summary>

## ğŸ” Commandes utiles (client/serveur)
</summary>

| Commande | UtilitÃ© |
|-----------|---------|
| `ipconfig` | Affiche IP actuelle |
| `ipconfig /all` | Affiche IP, masque, passerelle, DNS, MAC, DHCP |
| `ipconfig /release` | LibÃ¨re lâ€™IP |
| `ipconfig /renew` | Demande une nouvelle IP DHCP |
| `ipconfig /displaydns` | Affiche cache DNS |
| `ipconfig /flushdns` | Vide cache DNS |
| `ping <ip>` | Tester connectivitÃ© |
| `ping -t <ip>` | Ping continu |
| `tracert <host>` | Affiche route vers hÃ´te |
| `nslookup <nom>` | Tester rÃ©solution DNS |

---
</details>
<details>
<summary>

## âœ… Points essentiels
</summary>

- Toujours planifier rÃ©seau et Ã©tendue avant installation DHCP  
- Configurer IP statique serveur  
- GÃ©rer exclusions, rÃ©servations, filtres pour Ã©viter conflits  
- Comprendre calcul IP / masque / adresse rÃ©seau / broadcast  
- VÃ©rifier connectivitÃ© / DNS via commandes clients  
- SÃ©parer environnement labo (NAT network VirtualBox)  

---
</details>
<details>
<summary>

## âš ï¸ PiÃ¨ges frÃ©quents
</summary>

- Ã‰tendue non activÃ©e â†’ IP non distribuÃ©es  
- Exclusions non paramÃ©trÃ©es â†’ conflit IP  
- Filtre MAC mal configurÃ© â†’ client bloquÃ© / APIPA  
- Firewall bloquant ping â†’ diagnostic trompeur

---
</details>