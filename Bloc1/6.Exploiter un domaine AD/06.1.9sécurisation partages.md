<details>
<summary>

## ğŸ§© **Titre : Le paramÃ©trage et la sÃ©curisation des partages (Partie 1)**
</summary>

### ğŸ¯ **Objectif :**

Comprendre les enjeux de la sÃ©curisation des partages de fichiers et savoir configurer un serveur de fichiers sous Windows Server en appliquant correctement les droits NTFS.

---

### ğŸ’¡ **Concepts clÃ©s :**

* **Serveur de fichiers :**
  Instance centrale permettant aux utilisateurs du rÃ©seau dâ€™accÃ©der aux ressources partagÃ©es.

* **Impact dâ€™une mauvaise sÃ©curisation :**

  * Sur le **SI** : exposition Ã  des risques de sÃ©curitÃ© (atteinte Ã  la disponibilitÃ©, lâ€™intÃ©gritÃ© ou la confidentialitÃ©).
  * Sur le **client** : fuites de donnÃ©es personnelles, perte de rÃ©putation, sanctions lÃ©gales, vol dâ€™identitÃ©.

* **Exemples concrets :**

  * ChoicePoint (2005) â†’ fuite de 150 000 dossiers, 26 M$ dâ€™amende.
  * Facebook (2018) â†’ 500 000 GBP dâ€™amende pour traitement dÃ©loyal des donnÃ©es.

---

### âš™ï¸ **Commandes / Notes techniques :**

#### ğŸ”¹ **Les autorisations NTFS :**

NTFS (New Technology File System) = systÃ¨me de fichiers sÃ©curisÃ© utilisÃ© par Windows.
Chaque fichier/dossier est associÃ© Ã  une **DACL** (*Discretionary Access Control List*) listant les utilisateurs/groupes autorisÃ©s et leurs droits.

| Autorisation NTFS        | Description                                                                           |
| ------------------------ | ------------------------------------------------------------------------------------- |
| **Lecture**              | Consultation des fichiers et dossiers.                                                |
| **Ã‰criture**             | CrÃ©ation/modification de fichiers et dossiers.                                        |
| **Affichage du contenu** | Voir les noms des fichiers et dossiers.                                               |
| **Lecture et exÃ©cution** | AccÃ©der et exÃ©cuter des fichiers.                                                     |
| **Modification**         | Lecture, Ã©criture, exÃ©cution + suppression.                                           |
| **ContrÃ´le total**       | Tous les droits prÃ©cÃ©dents (lecture, Ã©criture, exÃ©cution, modification, suppression). |

> ğŸ“ Si un utilisateur ou groupe nâ€™est **pas listÃ© dans la DACL**, lâ€™accÃ¨s est **refusÃ© par dÃ©faut**.

---

#### ğŸ”¹ **ProcÃ©dure de configuration dâ€™un partage SMB sous Windows Server :**

1. **Ouvrir** : *Gestionnaire de serveur â†’ Tableau de bord.*
2. **AccÃ©der Ã ** : *Services de fichiers et de stockage â†’ Partage.*
3. **CrÃ©er un nouveau partage** : clic droit â†’ *Nouveau partage.*
4. **Choisir le type** : *Partage SMB â€“ Rapide â†’ Suivant.*
5. **SÃ©lectionner le serveur et le chemin dâ€™accÃ¨s** (ex : `C:\Shares`).
6. **Nommer le partage** et vÃ©rifier les chemins locaux/distants.
7. **Cocher** :

   * â€œActiver lâ€™Ã©numÃ©ration basÃ©e sur lâ€™accÃ¨sâ€
   * â€œAutoriser la mise en cache du partageâ€
8. **VÃ©rifier les paramÃ¨tres â†’ CrÃ©er.**
9. **Attribuer les droits NTFS** :

   * Clic droit sur le dossier partagÃ© â†’ *PropriÃ©tÃ©s â†’ SÃ©curitÃ© â†’ Modifier â†’ Ajouter utilisateur.*
   * SÃ©lectionner lâ€™utilisateur/groupe â†’ *Appliquer les autorisations* (lecture, modification, etc.).
10. **Valider la configuration.**

---

### ğŸ”— **Liens / Ressources :**

* Documentation Microsoft : [Gestion des partages SMB et NTFS](https://learn.microsoft.com/fr-fr/windows-server/storage/folder-redirection/deploy-folder-redirection)
* VidÃ©o de cours : *Les autorisations NTFS* (cf. module STS RÃ©seaux)

---
</details>
<details>
<summary>

# ğŸ§¾ Mise en Å“uvre dâ€™une infrastructure Active Directory (WS2019)
</summary>
<details>
<summary>

## ğŸ¯ Objectif

Mettre en place une infrastructure Active Directory complÃ¨te sous **Windows Server 2019** avec **AD DS**, **DNS**, **DHCP**, **NTFS** et **GPO**, dans un environnement **VirtualBox**.

---
</details>
<details>
<summary>

## ğŸ§© 1. PrÃ©paration du lab
</summary>

### ğŸ–¥ï¸ CrÃ©ation de la VM

* CrÃ©e une **VM Windows Server 2019** (nom : `SRV-CD01`)

  * 4 Go RAM, 35 Go disque, 2 CPU.
  * Monte lâ€™ISO de Windows Server 2019.
* Installe la version **â€œExpÃ©rience de bureauâ€**.
* Installe les **Guest Additions** aprÃ¨s le 1er dÃ©marrage.

### ğŸŒ RÃ©seau VirtualBox

* CrÃ©e un **rÃ©seau NAT** nommÃ© `WS2019` via *Fichier â†’ Gestionnaire de rÃ©seau hÃ´te/NAT*.
* **DÃ©sactive le DHCP** du rÃ©seau NAT (pour laisser le futur serveur gÃ©rer les IP).
* Affecte lâ€™interface rÃ©seau NAT Ã  la VM.

---
</details>
<details>
<summary>

## âš™ï¸ 2. Configuration initiale du serveur
</summary>

1. **Renomme le serveur** :
   â†’ *Panneau de configuration â†’ SystÃ¨me â†’ ParamÃ¨tres systÃ¨me avancÃ©s â†’ Nom de lâ€™ordinateur â†’ Modifier*
   â†’ Nom : `SRV-CD01`
2. **Attribue une IP statique** :
   â†’ *Panneau de configuration â†’ RÃ©seau â†’ Ethernet â†’ PropriÃ©tÃ©s â†’ IPv4*

   * IP : `10.0.2.50`
   * Masque : `255.255.255.0`
   * Passerelle : `10.0.2.1`
   * DNS : `8.8.8.8` (temporairement)
3. **Active le Bureau Ã  distance** :
   â†’ *Gestionnaire de serveur â†’ Serveur local â†’ Bureau Ã  distance : ActivÃ©*
4. RedÃ©marre le serveur.

---
</details>
<details>
<summary>

## ğŸ§± 3. Installation du rÃ´le Active Directory DS
</summary>

1. Ouvre le **Gestionnaire de serveur**.
2. Clique sur **â€œAjouter des rÃ´les et fonctionnalitÃ©sâ€** â†’

   * Type dâ€™installation : â€œRÃ´les et fonctionnalitÃ©sâ€
   * Coche **â€œServices de domaine Active Directory (AD DS)â€**
   * Suivant â†’ Installer
3. Une fois installÃ©, clique sur la **notification drapeau jaune â†’ â€œPromouvoir ce serveur en contrÃ´leur de domaineâ€**.
4. Choisis **â€œAjouter une nouvelle forÃªtâ€**, nom de domaine : `labo.local`.
5. DÃ©finis un mot de passe DSRM (sauvegarde).
6. Laisse les options DNS cochÃ©es â†’ Suivant â†’ Installer.
7. Le serveur redÃ©marre automatiquement.

ğŸ’¡ *AprÃ¨s redÃ©marrage, connecte-toi avec le compte Administrateur du domaine (`labo\Administrateur`).*

---
</details>
<details>
<summary>

## ğŸŒ 4. Configuration DNS
</summary>

1. Ouvre **Outils â†’ DNS** dans le Gestionnaire de serveur.
2. VÃ©rifie la **zone de recherche directe** (`labo.local`) crÃ©Ã©e automatiquement.
3. CrÃ©e une **zone de recherche inversÃ©e** :

   * Clic droit sur â€œZones de recherche inversÃ©eâ€ â†’ *Nouvelle zone*.
   * Type : â€œZone principaleâ€ â†’ â€œStockÃ©e dans ADâ€ â†’ IPv4 â†’ prÃ©fixe `10.0.2`.
4. Dans les propriÃ©tÃ©s du serveur â†’ coche **â€œCrÃ©er automatiquement un enregistrement PTRâ€**.
5. VÃ©rifie la rÃ©solution :

   ```bash
   nslookup SRV-CD01
   nslookup 10.0.2.50
   ```

   â†’ les deux doivent rÃ©pondre correctement.

---
</details>
<details>
<summary>

## ğŸ“¦ 5. Installation et configuration du DHCP
</summary>

1. **Gestionnaire de serveur â†’ Ajouter des rÃ´les et fonctionnalitÃ©s â†’ DHCP Server**.
2. Suivant â†’ Installer â†’ â€œTerminer la configuration DHCPâ€.
3. **Outils â†’ DHCP** â†’ clic droit sur IPv4 â†’ *Nouvelle Ã©tendue*.

   * Nom : â€œRÃ©seau principalâ€
   * Plage : `10.0.2.2` Ã  `10.0.2.100`
   * Masque : `/24`
   * Exclusion (ex. `10.0.2.50` pour le DC)
   * Passerelle : `10.0.2.1`
   * DNS : `10.0.2.50`
   * DurÃ©e du bail : 8 jours
   * Activer lâ€™Ã©tendue.
4. Le serveur distribue maintenant les IP aux clients du rÃ©seau VirtualBox.

---
</details>
<details>
<summary>

## ğŸ”’ 6. Bonnes pratiques aprÃ¨s installation
</summary>

* **Modifier la carte rÃ©seau** :
  DNS prÃ©fÃ©rÃ© = `10.0.2.50` (le serveur lui-mÃªme).
* **Installer les mises Ã  jour Windows**.
* **CrÃ©er un snapshot VirtualBox** : `AD+DNS+DHCP+MÃ J`.
* **Tester un client Windows** : lâ€™ajouter au domaine (`labo.local`).

---
</details>
<details>
<summary>

## ğŸ§° 7. Ã‰tapes suivantes (Ã  prÃ©voir)
</summary>

* CrÃ©er **OU, utilisateurs et groupes** (modÃ¨le **AGDLP**).
* Configurer les **droits NTFS** sur les partages rÃ©seau.
* DÃ©ployer des **GPO** de base : scripts de connexion, restrictions, redirection de dossiers.
* Installer un **serveur dâ€™impression** et publier les imprimantes.
* Planifier une **sauvegarde AD** (via `ntdsutil` ou sauvegarde systÃ¨me).

---
</details>
<details>
<summary>

## ğŸ§ª Commandes utiles
</summary>

```bash
nslookup SRV-CD01         # test DNS direct
nslookup 10.0.2.50        # test DNS inverse
gpupdate /force           # force la mise Ã  jour GPO
gpresult /r               # liste les GPO appliquÃ©es
```

---
</details>
<details>
<summary>

## âœ… Checklist de vÃ©rification
</summary>

* [ ] IP statique et nom serveur OK
* [ ] AD DS installÃ© et promu (`labo.local`)
* [ ] DNS direct + inverse configurÃ©s
* [ ] DHCP Ã©tendue active, clients obtiennent IP
* [ ] Serveur sâ€™utilise comme DNS (`10.0.2.50`)
* [ ] Snapshot pris
* [ ] Client ajoutÃ© au domaine

---
</details>
</details>
<details>
<summary>

# ğŸ§¾ Active Directory â€“ Gestion des utilisateurs, groupes et stockage
</summary>
<details>
<summary>

## 1. PrÃ©-requis serveur
</summary>

Avant de gÃ©rer AD :

* Fixer lâ€™IP du serveur.
* Changer le nom du serveur.
* Activer Bureau Ã  distance.
* Installer les rÃ´les :

  * **AD DS** + **DNS** (zone de recherche inversÃ©e).
  * Ã‰lever le serveur au **contrÃ´leur de domaine**.
  * **DHCP** et crÃ©er une **Ã©tendue** pour les clients.
* Mettre Ã  jour Windows et crÃ©er une **snapshot**.

---
</details>
<details>
<summary>

## 2. CrÃ©ation dâ€™UnitÃ©s dâ€™Organisation (UO)
</summary>

> Lâ€™UO sert Ã  organiser les objets (ordinateurs, utilisateurs, groupes) de maniÃ¨re hiÃ©rarchique.

**Ã‰tapes :**

1. Ouvrir **AD DS** â†’ clic droit sur serveur â†’ **Utilisateurs et ordinateurs Active Directory**.
2. DÃ©ployer le domaine (`labo.local`).
3. CrÃ©er une UO :

   * Clic droit sur `labo.local` â†’ **Nouveau** â†’ **UnitÃ© dâ€™organisation**.
   * Nom : `Ordinateurs`
   * Cocher â€œProtÃ©ger contre suppression accidentelleâ€ si nÃ©cessaire â†’ **OK**.
4. Pour modifier la protection contre suppression :

   * Affichage â†’ **FonctionnalitÃ©s avancÃ©es** â†’ clic droit sur UO â†’ **PropriÃ©tÃ©s** â†’ Onglet Objet â†’ dÃ©cocher â€œProtÃ©gerâ€.
5. CrÃ©er des **sous-UO** :

   * Exemple : `Nomades` (tÃ©lÃ©travail) et `Fixes` (bureaux).

---
</details>
<details>
<summary>

## 3. Ajout dâ€™ordinateurs dans AD
</summary>

1. Clic droit sur UO `Fixes` â†’ **Nouveau** â†’ **Ordinateur**.
2. Nommer selon la convention : `WS2019-Client-01`.
3. VÃ©rifier les propriÃ©tÃ©s â†’ lâ€™OS peut Ãªtre vide (profil crÃ©Ã© mais machine pas encore jointe au domaine).

---
</details>
<details>
<summary>

## 4. Gestion des utilisateurs
</summary>

### CrÃ©er UO pour employÃ©s

* Racine `labo.local` â†’ **Nouveau UO** â†’ `EmployÃ©s`.
* Sous-UO par service : `Direction`, `SecrÃ©tariat`.

### Ajouter utilisateurs

1. Sous UO `Direction` â†’ clic droit â†’ **Nouveau** â†’ **Utilisateur**.
2. Saisir : prÃ©nom, nom, identifiant (ex : `eteach`).
3. Choisir type de connexion : `eteach@labo.local` ou `LABO\eteach`.
4. Mot de passe :

   * DÃ©cocher â€œchanger Ã  la prochaine ouvertureâ€.
   * Cocher â€œmot de passe nâ€™expire jamaisâ€.
5. Terminer â†’ utilisateur crÃ©Ã©.

> RÃ©pÃ©ter pour chaque employÃ©.

---
</details>
<details>
<summary>

## 5. Gestion des groupes â€“ MÃ©thode AGDLP
</summary>

### Concept

* **AGDLP** = Account â†’ Global â†’ Domain Local â†’ Permissions.
* Avantage : gÃ©rer les droits via **groupes**, pas utilisateurs individuellement.
* Groupe global â†’ placÃ© dans un groupe de domaine local â†’ permissions NTFS sur dossiers.

### Mise en Å“uvre

1. CrÃ©er UO pour groupes :

   * `Groupes Globaux` (niveau global)
   * `Groupes de Domaine Local` (niveau local)
2. CrÃ©er groupes globaux :

   * Clic droit `Groupes Globaux` â†’ **Nouveau** â†’ **Groupe**.
   * Exemple : `Direction`, `SecrÃ©tariat`.
3. Ajouter utilisateurs dans groupes globaux :

   * Onglet **Membre de** â†’ **Ajouter** â†’ taper nom du groupe â†’ **VÃ©rifier les noms** â†’ **OK**.

### Imbrication dans groupes de domaine local

1. Clic droit `Groupes de Domaine Local` â†’ **Nouveau** â†’ **Groupe**.

   * Exemple : `GDL-Direction-Ecriture`, `GDL-Direction-Lecture`.
   * Cocher **Domaine local**.
2. Ajouter le groupe global correspondant dans le groupe de domaine local :

   * Onglet **Membres** â†’ **Ajouter** â†’ tapez nom du groupe global â†’ **VÃ©rifier** â†’ **OK**.

> RÃ©sultat : droits dâ€™Ã©criture pour direction, lecture seule pour secrÃ©tariat.

---
</details>
<details>
<summary>

## 6. Gestion des disques et pools de stockage (Windows Server + VirtualBox)
</summary>

### Ajouter disques dans VirtualBox

1. VM Ã©teinte â†’ **Configuration â†’ Stockage â†’ Ajouter contrÃ´leur USB**.
2. Ajouter disques VDI dynamiques (ex : 10 Go chacun).

### CrÃ©er pools de stockage

1. Gestionnaire de serveur â†’ **Services de fichiers et stockage** â†’ **Pools de stockage** â†’ **TÃ¢ches â†’ Nouveau pool**.
2. SÃ©lectionner disques â†’ Nommer pool â†’ Suivant â†’ **CrÃ©er**.

### CrÃ©er disques virtuels et volumes

1. Clic sur pool â†’ **TÃ¢ches â†’ Nouveau disque virtuel**.
2. Nom, description, type de disposition :

   * **Simple** si un disque
   * **Miroir** pour RAID1 si 2 disques
3. DÃ©finir taille â†’ **CrÃ©er**.
4. CrÃ©er volume sur disque virtuel â†’ attribuer lettre (ex : `E:` Data EmployÃ©s).

> VÃ©rifier dans **Explorateur de fichiers**.

---
</details>
<details>
<summary>

## 7. PrÃ©parer une machine client
</summary>

1. Cloner Windows 10 â†’ Nom : `WS2019Client`.
2. Configurer rÃ©seau â†’ mÃªme NAT que serveur.
3. Lancer la VM â†’ autoriser dÃ©couverte rÃ©seau.

---
</details>
</details>